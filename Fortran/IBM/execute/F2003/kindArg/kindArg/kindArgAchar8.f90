!*********************************************************************
!*  ===================================================================
!*
!*  DATE                       : Jun. 12, 2006
!*
!*  PRIMARY FUNCTIONS TESTED   : New Kind argumnet for existing intrinsics
!*
!*  SECONDARY FUNCTIONS TESTED : ACHAR
!*
!*  REFERENCE                  : Feature Number 289083
!*
!*  REQUIRED COMPILER OPTIONS  : -qfree=f90
!*
!*  KEYWORD(S)                 :
!*  TARGET(S)                  :
!*  NUMBER OF TESTS CONDITIONS :
!*
!*  DESCRIPTION
!*
!*  Achar called in arr constructor
!*
!*  ()
!*
!234567890123456789012345678901234567890123456789012345678901234567890


  PROGRAM kindArgAchar8
  IMPLICIT NONE


  INTEGER(1), ALLOCATABLE :: II1(:)
  INTEGER(4), ALLOCATABLE :: I4
  INTEGER(8), POINTER     :: I8

  INTEGER                 :: I

! CHARACTER :: CC(0:127)=(/(ACHAR(I=I, KIND=1), I=0, 127)/)

  CHARACTER :: CC(0:127)
  CC=(/(ACHAR(I=I, KIND=1), I=0, 127)/)

  ALLOCATE(I4)
  ALLOCATE(I8)


  ALLOCATE(II1(128))

  DO I4 = 0, 127
    IF (ANY((/ACHAR(I4, KIND=IACHAR(ACHAR(1, KIND=1_1), KIND=8))/)  .NE. CC(I4:I4)) ) ERROR STOP 11
    IF (ANY((/ACHAR(I4, KIND=IACHAR(ACHAR(1, KIND=1_2), KIND=4))/)  .NE. CC(I4:I4)) ) ERROR STOP 12
    IF (ANY((/ACHAR(I4, KIND=IACHAR(ACHAR(1, KIND=1_4), KIND=2))/)  .NE. CC(I4:I4)) ) ERROR STOP 13
    IF (ANY((/ACHAR(I4, KIND=IACHAR(ACHAR(1, KIND=1_8), KIND=1))/)  .NE. CC(I4:I4)) ) ERROR STOP 14
  END DO

  DO I8 = 0, 127
    IF (ANY((/ACHAR(I8, KIND=KIND(IACHAR(ACHAR(I8), KIND=1_8)))/)  .NE. CC(I8:I8)) ) ERROR STOP 21
    IF (ANY((/ACHAR(I8, KIND=KIND(IACHAR(ACHAR(I8), KIND=1_4)))/)  .NE. CC(I8:I8)) ) ERROR STOP 22
    IF (ANY((/ACHAR(I8, KIND=KIND(IACHAR(ACHAR(I8), KIND=1_2)))/)  .NE. CC(I8:I8)) ) ERROR STOP 23
    IF (ANY((/ACHAR(I8, KIND=KIND(IACHAR(ACHAR(I8), KIND=1_1)))/)  .NE. CC(I8:I8)) ) ERROR STOP 24
  END DO


  II1=(/(I, I=0,127)/)
  IF (ANY((/ACHAR(I=II1, KIND=IACHAR(ACHAR(I=1_1, KIND=1_1), KIND=8_1))/)  .NE. CC )) ERROR STOP 111
  IF (ANY((/ACHAR(I=II1, KIND=IACHAR(ACHAR(I=1_2, KIND=1_2), KIND=4_4))/)  .NE. CC )) ERROR STOP 112
  IF (ANY((/ACHAR(I=II1, KIND=IACHAR(ACHAR(I=1_4, KIND=1_4), KIND=2_8))/)  .NE. CC )) ERROR STOP 113
  IF (ANY((/ACHAR(I=II1, KIND=IACHAR(ACHAR(I=1_8, KIND=1_8), KIND=1_2))/)  .NE. CC )) ERROR STOP 114


  END

